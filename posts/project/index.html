<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>项目 | Erica-Blog</title>
<meta name=keywords content="工作"><meta name=description content="kv存储项目 一个db的实例理解成os上的文件夹，除了一些配置，关注的是数据文件，最主要的是当前的活跃文件，only用来w操作，追加到文件尾部"><meta name=author content="erica423"><link rel=canonical href=https://erica423.github.io/posts/project/><link crossorigin=anonymous href=/assets/css/stylesheet.0fd2af49d7c8b1a279992ba82155f4ce3b1d94189758b3b0a99c8692cfdc0be9.css integrity rel="preload stylesheet" as=style><link rel=icon href=https://erica423.github.io/images/dls_icon.png><link rel=icon type=image/png sizes=16x16 href=https://erica423.github.io/images/dls_icon.png><link rel=icon type=image/png sizes=32x32 href=https://erica423.github.io/images/dls_icon.png><link rel=apple-touch-icon href=https://erica423.github.io/images/dls_icon.png><link rel=mask-icon href=https://erica423.github.io/images/dls_icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://erica423.github.io/posts/project/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>(function(){"12345"&&prompt("请输入文章密码")!=="12345"&&(alert("密码错误！"),history.back())})()</script><link rel=stylesheet href=https://s1.hdslb.com/bfs/static/jinkela/long/font/regular.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap" rel=stylesheet><script src=https://unpkg.com/@waline/client@v2/dist/waline.js></script><link rel=stylesheet href=https://unpkg.com/@waline/client@v2/dist/waline.css><meta property="og:title" content="项目"><meta property="og:description" content="kv存储项目 一个db的实例理解成os上的文件夹，除了一些配置，关注的是数据文件，最主要的是当前的活跃文件，only用来w操作，追加到文件尾部"><meta property="og:type" content="article"><meta property="og:url" content="https://erica423.github.io/posts/project/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-15T14:57:57+08:00"><meta property="article:modified_time" content="2024-08-15T14:57:57+08:00"><meta property="og:site_name" content="erica-blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="项目"><meta name=twitter:description content="kv存储项目 一个db的实例理解成os上的文件夹，除了一些配置，关注的是数据文件，最主要的是当前的活跃文件，only用来w操作，追加到文件尾部"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://erica423.github.io/posts/"},{"@type":"ListItem","position":2,"name":"项目","item":"https://erica423.github.io/posts/project/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"项目","name":"项目","description":"kv存储项目 一个db的实例理解成os上的文件夹，除了一些配置，关注的是数据文件，最主要的是当前的活跃文件，only用来w操作，追加到文件尾部","keywords":["工作"],"articleBody":"kv存储项目 一个db的实例理解成os上的文件夹，除了一些配置，关注的是数据文件，最主要的是当前的活跃文件，only用来w操作，追加到文件尾部。\n写入的数据称作entry，结构：\n一个数据文件看成好多entry的集合\n冗余数据处理：reclaim方法，重新整理（新建tmp文件夹，遍历db，依次取出entry判断有效否，写入有效的，将tmp copy为新的，最后将原来的文件delete）\nwhy string类型存入跳表？ 为了支持字符串的前缀扫描和范围扫描，不需要的话就换成哈希表即可。 Disk磁盘写操作一定是顺序写入，类似LSM树，提升w性能。常见数据索引模型还有b+树。 外层操作接口：\ndb_str.go (略有不同) db_list.go db_hash.go db_set.go db_zset.go 基于go-zero的仿知乎微服务项目 （一）项目概述 1.1 架构图 1.2 核心技术 微服务框架：go-zero 服务编排：k8s 数据库：MySQL 缓存：Redis 消息队列：Kafka 1.3 项目特点 微服务架构设计，从单体架构到微服务架构拆解 高并发，模拟高并发场景，性能优化和架构调整 深入理解源码和原理 部署上线 1.4 核心功能 服务注册与发现，负载均衡 监控 告警 链路追踪 缓存异常的处理，穿透、击穿、雪崩、缓存数据库一致性保证 秒杀场景，超高并发读写（10w qps，压测） 请求耗时高的优化 聊天室 问题排查定位方法 CICD完整部署上线，可访问 1.5 依赖 本地安装Go，Go版本go1.21.0 go-zero 官方文档 本地安装 goctl 本地安装protoc，protoc-gen-go 安装教程 可访问的MySQL，Redis，Etcd，对版本不做要求 IDE，VSCode 终端 iTerm2 调试工具 Postman 浏览器 Chrome 服务拆分 微服务 将单体应划分成一组小的服务，服务之间互相协调、互相配合，为用户提供最终价值。每个服务运行在其独立的进程中，服务与服务间采用轻量级的通信机制互相沟通（通常是基于RPC或者RESTful API）。每个服务都围绕着具体业务进行构建，并且能够独立地部署到生产环境\n微服务划分方式\nDDD 限界上下文 垂直功能: 独立业务功能进行划分，比如评论服务，用户服务，购物车服务等就可以独立的划分为一个微服务 服务划分：文章、问答、聊天、关注、会员、消息、用户\n微服务架构\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 tree -L 3 ./ ./ ├── README.md ├── application // 所有的微服务 │ ├── applet // HTTP服务 │ │ ├── README.md │ │ ├── applet.api // API │ │ ├── applet.go │ │ ├── etc │ │ └── internal // 不对外访问 │ ├── article │ │ ├── README.md │ │ └── rpc │ ├── chat │ │ ├── README.md │ │ └── rpc │ ├── concerned │ │ ├── README.md │ │ └── rpc │ ├── member │ │ ├── README.md │ │ └── rpc │ ├── message │ │ ├── README.md │ │ └── rpc │ ├── qa │ │ ├── README.md │ │ └── rpc │ └── user │ ├── README.md │ └── rpc ├── db │ └── user.sql ├── go.mod ├── go.sum └── pkg // 通用方法工具 ├── encrypt │ ├── encrypt.go │ └── encrypt_test.go ├── jwt │ └── token.go └── util └── util.go 第一课 文档 https://pwmzlkcu3p.feishu.cn/docx/HsMIdfEa0ogEvmxCpRrcEOyenqc\n视频 https://www.bilibili.com/video/BV1op4y177iS/\n第二课 文档 https://pwmzlkcu3p.feishu.cn/docx/XX6xdpB0UoH0auxgPYlcxmninDb\n视频 https://www.bilibili.com/video/BV1CH4y1Q7PM/\n第三课 文档 https://pwmzlkcu3p.feishu.cn/docx/XLB9dK9Cao3Z7HxPyEscu0P9nIb\n视频 https://www.bilibili.com/video/BV19u411w7WS/\n自定义业务错误码，注意RPC错误码 拦截器\n第四课 文档 https://pwmzlkcu3p.feishu.cn/docx/U9FGdVAFuoFFiUxySsgcl5TMnke\n视频 https://www.bilibili.com/video/BV1Y8411q7uW/\n文章 发布文章 展示文章 点赞 评论 关联标签 mysql + redis + kafka + es + canal 第五课 文档 https://pwmzlkcu3p.feishu.cn/docx/EBzWdSFR5oPVMJxP1oOcUGojnTd\n视频 https://www.bilibili.com/video/BV1k8411y7W5/\n第六课 文档 https://pwmzlkcu3p.feishu.cn/docx/O1u3d9pqWo4sZTx6NTxcOHhknmd\n视频 https://www.bilibili.com/video/BV1F84y1S74g/\n第七课 文档 https://pwmzlkcu3p.feishu.cn/docx/SvSwdAETNo3F0Axznp8ceaX1nIb\n视频 https://www.bilibili.com/video/BV1sz4y1G73u/\n第八课 文档 https://pwmzlkcu3p.feishu.cn/docx/At4zdJzrFowGMmx5OjJcrS5mnir\n视频 https://www.bilibili.com/video/BV1S8411C7CY/\n缓存索引 查看某个用户发布过的文章需要支持分页的，通过往上滑动可以不断地加载下一页，文章支持按照点赞数和发布时间倒序返回列表，使用游标的方式进行分页。 怎么在缓存中存储用户的文章列表呢？我们使用Sorted Set来存储，member为文章的的id，即我们只在Sorted Set中存储缓存索引，查出缓存索引后，因为我们自动生成了以主键id索引为key的缓存，所以查出索引列表后我们再查询行记录缓存即可获取文章的详情，Sorted Set的score为文章的点赞数或者文章发布时间。 下面我们一起来分析文章列表的逻辑该怎么写，首先先从缓存中读取当前页的文章id索引，调用cacheArticleList方法，注意，这里调用查询缓存方法忽略了error，为什么要忽略这个error呢，因为我们期望的是尽最大可能的给用户返回数据，也就是redis挂掉了的话那我们就会从数据库查询数据返回给用户，而不会因为redis挂掉而返回错误。\n第九课 文档 https://pwmzlkcu3p.feishu.cn/docx/OW6Sd0ZsioU9LLxuUSXcUZgNnoD\n视频 https://www.bilibili.com/video/BV1oB4y1f7Tr/\n第十课 文档 https://pwmzlkcu3p.feishu.cn/docx/Si1Cd4EGxoZXkJxGenzcFttOnsh\n视频 https://www.bilibili.com/video/BV1je411R7iy/\n第十一课 文档 https://pwmzlkcu3p.feishu.cn/docx/NYyHdpSzhoB8Zkxdb6NcpUGynH4\n视频 https://www.bilibili.com/video/BV11u4y1Y7GC/\n第十二课 文档 https://pwmzlkcu3p.feishu.cn/docx/QZcKdB4VXoUCRDxGilfcTaw7n8e\n视频 https://www.bilibili.com/video/BV1u64y177rL\n第十三课 文档 https://pwmzlkcu3p.feishu.cn/docx/BDNUdhmP4oec6ix1P1ZcqF3rnIc\n视频 https://www.bilibili.com/video/BV1bH4y1C7Uj\n第十四课 文档 https://pwmzlkcu3p.feishu.cn/docx/Ydd4dG8OSobJ1rxJFgacOBKvnSg\n","wordCount":"1751","inLanguage":"en","datePublished":"2024-08-15T14:57:57+08:00","dateModified":"2024-08-15T14:57:57+08:00","author":{"@type":"Person","name":"erica423"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://erica423.github.io/posts/project/"},"publisher":{"@type":"Organization","name":"Erica-Blog","logo":{"@type":"ImageObject","url":"https://erica423.github.io/images/dls_icon.png"}}}</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><meta name=referrer content="no-referrer-when-downgrade"></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://erica423.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://erica423.github.io/images/dls_icon.png alt aria-label=logo height=25>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://erica423.github.io/archives/ title=🎮动态><span>🎮动态</span></a></li><li><a href=https://erica423.github.io/tags/ title=🎲标签><span>🎲标签</span></a></li><li><a href=https://erica423.github.io/search/ title="🎯搜索 (Alt + /)" accesskey=/><span>🎯搜索</span></a></li><li><a href=https://github.com/Erica423/Erica423.github.io/ title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://erica423.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://erica423.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">项目</h1><div class=post-meta><span title='2024-08-15 14:57:57 +0800 +0800'>August 15, 2024</span>&nbsp;·&nbsp;erica423&nbsp;|&nbsp;<a href=https://github.com/Erica423/Erica423.github.io rel="noopener noreferrer" target=_blank>主页</a><div class=meta-item>&nbsp·&nbsp
	      <span id=busuanzi_container_page_pv>本文阅读量<span id=busuanzi_value_page_pv></span>次</span></div></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#kv存储项目>kv存储项目</a></li><li><a href=#基于go-zero的仿知乎微服务项目>基于go-zero的仿知乎微服务项目</a><ul><li><a href=#一项目概述>（一）项目概述</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=kv存储项目>kv存储项目<a hidden class=anchor aria-hidden=true href=#kv存储项目>#</a></h2><p>一个db的实例理解成os上的文件夹，除了一些配置，关注的是数据文件，最主要的是当前的活跃文件，only用来w操作，追加到文件尾部。</p><p>写入的数据称作entry，结构：</p><p>一个数据文件看成好多entry的集合</p><p>冗余数据处理：reclaim方法，重新整理（新建tmp文件夹，遍历db，依次取出entry判断有效否，写入有效的，将tmp copy为新的，最后将原来的文件delete）</p><p><img loading=lazy src=/images/%e6%95%b0%e6%8d%ae%e5%86%99%e5%85%a5%e6%b5%81%e7%a8%8b.png#center alt=db数据读入流程></p><ul><li>why string类型存入<strong>跳表</strong>？ 为了支持字符串的<strong>前缀扫描</strong>和<strong>范围扫描</strong>，不需要的话就换成哈希表即可。</li><li>Disk磁盘写操作一定是顺序写入，类似LSM树，提升w性能。常见数据索引模型还有b+树。</li></ul><p>外层操作接口：</p><ul><li>db_str.go (略有不同)</li><li>db_list.go</li><li>db_hash.go</li><li>db_set.go</li><li>db_zset.go</li></ul><hr><h2 id=基于go-zero的仿知乎微服务项目>基于go-zero的仿知乎微服务项目<a hidden class=anchor aria-hidden=true href=#基于go-zero的仿知乎微服务项目>#</a></h2><h3 id=一项目概述>（一）项目概述<a hidden class=anchor aria-hidden=true href=#一项目概述>#</a></h3><h4 id=11-架构图>1.1 架构图<a hidden class=anchor aria-hidden=true href=#11-架构图>#</a></h4><p><img loading=lazy src=/images/whiteboard_exported_image.png alt=架构图></p><h4 id=12-核心技术>1.2 核心技术<a hidden class=anchor aria-hidden=true href=#12-核心技术>#</a></h4><ul><li>微服务框架：go-zero</li><li>服务编排：k8s</li><li>数据库：MySQL</li><li>缓存：Redis</li><li>消息队列：Kafka</li></ul><h4 id=13-项目特点>1.3 项目特点<a hidden class=anchor aria-hidden=true href=#13-项目特点>#</a></h4><ul><li>微服务架构设计，从单体架构到微服务架构拆解</li><li>高并发，模拟高并发场景，性能优化和架构调整</li><li>深入理解源码和原理</li><li>部署上线</li></ul><h4 id=14-核心功能>1.4 核心功能<a hidden class=anchor aria-hidden=true href=#14-核心功能>#</a></h4><ul><li>服务注册与发现，负载均衡</li><li>监控 告警 链路追踪</li><li>缓存异常的处理，穿透、击穿、雪崩、缓存数据库一致性保证</li><li>秒杀场景，超高并发读写（10w qps，压测）</li><li>请求耗时高的优化</li><li>聊天室</li><li>问题排查定位方法</li><li>CICD完整部署上线，可访问</li></ul><h4 id=15-依赖>1.5 依赖<a hidden class=anchor aria-hidden=true href=#15-依赖>#</a></h4><ul><li>本地安装Go，Go版本go1.21.0</li><li>go-zero <a href=https://go-zero.dev/docs/tasks/dsl/proto>官方文档</a></li><li>本地安装 goctl</li><li>本地安装protoc，protoc-gen-go <a href="https://blog.csdn.net/hblzong/article/details/141333726?spm=1001.2101.3001.6650.4&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EYuanLiJiHua%7EPosition-4-141333726-blog-138313465.235%5Ev43%5Epc_blog_bottom_relevance_base5&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EYuanLiJiHua%7EPosition-4-141333726-blog-138313465.235%5Ev43%5Epc_blog_bottom_relevance_base5&amp;utm_relevant_index=9">安装教程</a></li><li>可访问的MySQL，Redis，Etcd，对版本不做要求</li><li>IDE，VSCode</li><li>终端 iTerm2</li><li>调试工具 Postman</li><li>浏览器 Chrome</li></ul><h4 id=服务拆分>服务拆分<a hidden class=anchor aria-hidden=true href=#服务拆分>#</a></h4><ul><li>微服务</li></ul><p>将单体应划分成一组小的服务，服务之间互相协调、互相配合，为用户提供最终价值。每个服务运行在其独立的进程中，服务与服务间采用轻量级的通信机制互相沟通（通常是基于<strong>RPC</strong>或者RESTful API）。每个服务都围绕着具体业务进行构建，并且能够独立地部署到生产环境</p><ul><li><p>微服务划分方式</p><ul><li>DDD 限界上下文 <img loading=lazy src=/static/images/DDD.JPEG alt=DDD分层></li><li>垂直功能: 独立业务功能进行划分，比如评论服务，用户服务，购物车服务等就可以独立的划分为一个微服务</li></ul></li><li><p>服务划分：文章、问答、聊天、关注、会员、消息、用户</p></li><li><p>微服务架构</p></li></ul><p><img loading=lazy src=/static/images/%e5%be%ae%e6%9c%8d%e5%8a%a1%e6%9e%b6%e6%9e%84%e5%9b%be.png alt=微服务架构图></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tree -L <span class=m>3</span> ./
</span></span><span class=line><span class=cl>./
</span></span><span class=line><span class=cl>├── README.md
</span></span><span class=line><span class=cl>├── application  // 所有的微服务
</span></span><span class=line><span class=cl>│   ├── applet  //  HTTP服务
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   ├── applet.api  // API
</span></span><span class=line><span class=cl>│   │   ├── applet.go
</span></span><span class=line><span class=cl>│   │   ├── etc
</span></span><span class=line><span class=cl>│   │   └── internal  // 不对外访问
</span></span><span class=line><span class=cl>│   ├── article
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   └── rpc
</span></span><span class=line><span class=cl>│   ├── chat
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   └── rpc
</span></span><span class=line><span class=cl>│   ├── concerned
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   └── rpc
</span></span><span class=line><span class=cl>│   ├── member
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   └── rpc
</span></span><span class=line><span class=cl>│   ├── message
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   └── rpc
</span></span><span class=line><span class=cl>│   ├── qa
</span></span><span class=line><span class=cl>│   │   ├── README.md
</span></span><span class=line><span class=cl>│   │   └── rpc
</span></span><span class=line><span class=cl>│   └── user
</span></span><span class=line><span class=cl>│       ├── README.md
</span></span><span class=line><span class=cl>│       └── rpc
</span></span><span class=line><span class=cl>├── db
</span></span><span class=line><span class=cl>│   └── user.sql
</span></span><span class=line><span class=cl>├── go.mod
</span></span><span class=line><span class=cl>├── go.sum
</span></span><span class=line><span class=cl>└── pkg  // 通用方法工具
</span></span><span class=line><span class=cl>    ├── encrypt
</span></span><span class=line><span class=cl>    │   ├── encrypt.go
</span></span><span class=line><span class=cl>    │   └── encrypt_test.go
</span></span><span class=line><span class=cl>    ├── jwt
</span></span><span class=line><span class=cl>    │   └── token.go
</span></span><span class=line><span class=cl>    └── util
</span></span><span class=line><span class=cl>        └── util.go
</span></span></code></pre></td></tr></table></div></div><p>第一课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/HsMIdfEa0ogEvmxCpRrcEOyenqc>https://pwmzlkcu3p.feishu.cn/docx/HsMIdfEa0ogEvmxCpRrcEOyenqc</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1op4y177iS/>https://www.bilibili.com/video/BV1op4y177iS/</a></p><p>第二课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/XX6xdpB0UoH0auxgPYlcxmninDb>https://pwmzlkcu3p.feishu.cn/docx/XX6xdpB0UoH0auxgPYlcxmninDb</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1CH4y1Q7PM/>https://www.bilibili.com/video/BV1CH4y1Q7PM/</a></p><p>第三课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/XLB9dK9Cao3Z7HxPyEscu0P9nIb>https://pwmzlkcu3p.feishu.cn/docx/XLB9dK9Cao3Z7HxPyEscu0P9nIb</a></p><p>视频
<a href=https://www.bilibili.com/video/BV19u411w7WS/>https://www.bilibili.com/video/BV19u411w7WS/</a></p><p>自定义业务错误码，注意RPC错误码
拦截器</p><p>第四课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/U9FGdVAFuoFFiUxySsgcl5TMnke>https://pwmzlkcu3p.feishu.cn/docx/U9FGdVAFuoFFiUxySsgcl5TMnke</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1Y8411q7uW/>https://www.bilibili.com/video/BV1Y8411q7uW/</a></p><ul><li>文章<ul><li>发布文章</li><li>展示文章</li><li>点赞 评论 关联标签</li></ul></li><li>mysql + redis + kafka + es + canal</li></ul><p>第五课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/EBzWdSFR5oPVMJxP1oOcUGojnTd>https://pwmzlkcu3p.feishu.cn/docx/EBzWdSFR5oPVMJxP1oOcUGojnTd</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1k8411y7W5/>https://www.bilibili.com/video/BV1k8411y7W5/</a></p><p>第六课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/O1u3d9pqWo4sZTx6NTxcOHhknmd>https://pwmzlkcu3p.feishu.cn/docx/O1u3d9pqWo4sZTx6NTxcOHhknmd</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1F84y1S74g/>https://www.bilibili.com/video/BV1F84y1S74g/</a></p><p>第七课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/SvSwdAETNo3F0Axznp8ceaX1nIb>https://pwmzlkcu3p.feishu.cn/docx/SvSwdAETNo3F0Axznp8ceaX1nIb</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1sz4y1G73u/>https://www.bilibili.com/video/BV1sz4y1G73u/</a></p><p>第八课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/At4zdJzrFowGMmx5OjJcrS5mnir>https://pwmzlkcu3p.feishu.cn/docx/At4zdJzrFowGMmx5OjJcrS5mnir</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1S8411C7CY/>https://www.bilibili.com/video/BV1S8411C7CY/</a></p><p>缓存索引
查看某个用户发布过的文章需要支持分页的，通过往上滑动可以不断地加载下一页，文章支持按照点赞数和发布时间倒序返回列表，使用游标的方式进行分页。
怎么在缓存中存储用户的文章列表呢？我们使用Sorted Set来存储，member为文章的的id，即我们只在Sorted Set中存储缓存索引，查出缓存索引后，因为我们自动生成了以主键id索引为key的缓存，所以查出索引列表后我们再查询行记录缓存即可获取文章的详情，Sorted Set的score为文章的点赞数或者文章发布时间。
下面我们一起来分析文章列表的逻辑该怎么写，首先先从缓存中读取当前页的文章id索引，调用cacheArticleList方法，注意，这里调用查询缓存方法忽略了error，为什么要忽略这个error呢，因为我们期望的是尽最大可能的给用户返回数据，也就是redis挂掉了的话那我们就会从数据库查询数据返回给用户，而不会因为redis挂掉而返回错误。</p><p>第九课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/OW6Sd0ZsioU9LLxuUSXcUZgNnoD>https://pwmzlkcu3p.feishu.cn/docx/OW6Sd0ZsioU9LLxuUSXcUZgNnoD</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1oB4y1f7Tr/>https://www.bilibili.com/video/BV1oB4y1f7Tr/</a></p><p>第十课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/Si1Cd4EGxoZXkJxGenzcFttOnsh>https://pwmzlkcu3p.feishu.cn/docx/Si1Cd4EGxoZXkJxGenzcFttOnsh</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1je411R7iy/>https://www.bilibili.com/video/BV1je411R7iy/</a></p><p>第十一课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/NYyHdpSzhoB8Zkxdb6NcpUGynH4>https://pwmzlkcu3p.feishu.cn/docx/NYyHdpSzhoB8Zkxdb6NcpUGynH4</a></p><p>视频
<a href=https://www.bilibili.com/video/BV11u4y1Y7GC/>https://www.bilibili.com/video/BV11u4y1Y7GC/</a></p><p>第十二课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/QZcKdB4VXoUCRDxGilfcTaw7n8e>https://pwmzlkcu3p.feishu.cn/docx/QZcKdB4VXoUCRDxGilfcTaw7n8e</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1u64y177rL>https://www.bilibili.com/video/BV1u64y177rL</a></p><p>第十三课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/BDNUdhmP4oec6ix1P1ZcqF3rnIc>https://pwmzlkcu3p.feishu.cn/docx/BDNUdhmP4oec6ix1P1ZcqF3rnIc</a></p><p>视频
<a href=https://www.bilibili.com/video/BV1bH4y1C7Uj>https://www.bilibili.com/video/BV1bH4y1C7Uj</a></p><p>第十四课
文档
<a href=https://pwmzlkcu3p.feishu.cn/docx/Ydd4dG8OSobJ1rxJFgacOBKvnSg>https://pwmzlkcu3p.feishu.cn/docx/Ydd4dG8OSobJ1rxJFgacOBKvnSg</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://erica423.github.io/tags/%E5%B7%A5%E4%BD%9C/>工作</a></li></ul><nav class=paginav><a class=prev href=https://erica423.github.io/posts/algorithm/><span class=title>« Prev</span><br><span>算法</span>
</a><a class=next href=https://erica423.github.io/posts/rpc/><span class=title>Next »</span><br><span>RPC相关</span></a></nav></footer><div id=waline></div><script>Waline.init({el:"#waline",dark:"body.dark",serverURL:"https://waline.vercel.app"})</script></article></main><footer class=footer><span>&copy; 2024 <a href=https://erica423.github.io/>Erica-Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><div class=busuanzi-footer><span id=busuanzi_container_site_pv>本站总访问量<span id=busuanzi_value_site_pv></span>次
</span><span id=busuanzi_container_site_uv>本站访客数<span id=busuanzi_value_site_uv></span>人次</span></div></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>